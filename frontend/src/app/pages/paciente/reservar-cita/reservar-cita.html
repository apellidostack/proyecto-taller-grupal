<div class="card p-4"> 
  <h2>Reservar Cita</h2>
<form [formGroup]="formCita" (ngSubmit)="reservarCita()" class="mt-4">
  <!-- Selección de fecha -->
  <div class="mb-3">
    <label>Fecha</label>
    <p-date-picker 
      formControlName="fecha" 
      [showIcon]="true"
      dateFormat="yy-mm-dd"
      (onSelect)="onFechaSeleccionada()">
    </p-date-picker>
  </div>

  <!-- Tabla de horarios -->
  <p-table [value]="horarios" selectionMode="single" [(selection)]="horarioSeleccionado" 
           (onRowSelect)="onHorarioSeleccionado($event.data)">
    <ng-template pTemplate="header">
      <tr>
        <th>Día Semana</th>
        <th>Inicio</th>
        <th>Fin</th>
        <th>Duración</th>
        <th>Médico</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-horario>
      <tr [pSelectableRow]="horario">
        <td>{{horario.dia_semana}}</td>
        <td>{{horario.tiempo_inicio}}</td>
        <td>{{horario.tiempo_final}}</td>
        <td>{{horario.duracion_cita}}</td>
        <td>{{horario.medico_id}}</td>
      </tr>
    </ng-template>
  </p-table>

  <!-- Formulario de cita -->
  
    <div class="mb-3">
      <label>Razón de la cita</label>
      <textarea rows="1" pInputTextarea formControlName="razon"></textarea>
    </div>

    <div class="grid">
      <div class="col">
        <label>Hora Inicio</label>
        <input pInputText formControlName="tiempo_inicio" readonly />
      </div>
      <div class="col">
        <label>Hora Fin</label>
        <input pInputText formControlName="tiempo_final" readonly />
      </div>
    </div>

    <button pButton type="submit" label="Reservar" class="mt-3" [disabled]="!horarioSeleccionado || !formCita.get('fecha')?.value"></button>
  </form>
</div>

<p-toast></p-toast>



